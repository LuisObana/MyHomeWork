## Cornerstone of Windoes Security

Speaker: Sami Laiho

Event: Helsec Meetup November 2022

Link: https://www.youtube.com/watch?v=Y09nAxZFKzc 

Quote: *You don't have to make your security perfect, just better than your neighbour's*

At the start of the conference, Sami, the speaker expresses joy at being in Finland and shares a humorous anecdote about mistakenly entering the wrong building for the event. The talk is titled "Cornerstones of Windows Security," presented by Sami Laiho, the newly appointed Chief Research Officer for ThreSec. He reflects on his 12 years of self-employment and recent return to work, highlighting his experience in IT and the establishment of a training company. Sami discusses his computer preferences and recent transition to being employed, emphasizing his dedication to security and his role as a Microsoft MVP in the core operating system. Despite initial dislike for security sessions, he transitioned to focus on security about seven years ago.

He then elaborate how he disliked previous security sessions that focused on hacking without providing practical solutions for mitigation. Many demos showcased vulnerabilities in improperly configured systems, which the speaker found uninteresting. They express the importance of security in properly configured enterprise environments. The speaker, now Chief Research Officer at ThreSec, explains their unconventional title choice, "Senior Technical Fellow," in their previous company to stand out at conferences. The current title, Chief Research Officer, is chosen in tribute to Mikko H. The speaker emphasizes a preference for substance over titles.

Furthermore, the speaker recounts an experience at their company's headquarters in Stockholm, attempting to access the office of the consultants but being restricted due to their Chief title. They humorously describes the management office as boring, with gigantic screens and beverages, and expresses a desire to switch back to the normal side. The speaker introduces themselves as a Chief and shares quotes emphasizing the goal of making security better rather than perfect. They highlight the importance of scaring off potential attackers and share insights from their experience in security audits, including the significance of customizing Azure login pages.

Sami emphasizes the importance of properly configuring the front door of security, such as customizing the login page, as an indicator of an organization's overall security posture. They mention a blog post that covers more technical details and express concern about their blog being blocked, possibly due to a recent article. The main topic is the building blocks for a properly configured enterprise Windows system, including BitLocker, the principle of least privilege, patching, directory tiering, baseline configurations, binary control (allow-listing/white-listing), device control, multi-factor authentication (MFA), security operations center, and extended detection and response (XDR). Due to time constraints, the speaker plans to cover these topics in a condensed manner and mentions a future speaking engagement in Estonia with a similar content focus. The talk begins with a discussion on BitLocker, highlighting its role in ensuring the integrity of the operating system rather than merely encrypting data.

He continues discussing BitLocker, emphasizing its role in ensuring the integrity of the operating system rather than just data encryption. They share a humorous anecdote about explaining the importance of BitLocker to enterprise engineers who argue they have no important data since everything is stored in the cloud. The speaker highlights the prevalence of device theft at airports, especially Lenovo ThinkPads, and mentions the USB killer device that fries motherboards. They describe the common method of laptop theft at security points in airports and share an amusing incident at Oslo airport involving the USB killer.

Sami then describes the common method of laptop theft at airports, mentioning that stolen laptops are usually Apple devices, especially MacBooks. They share a humorous note about the theft being mainly from women and only involving MacBooks, even though the reality is that 800,000 devices are stolen annually. The speaker then talks about securely decommissioning disks, recommending the use of format.com with Windows PE or installation media to wipe BitLocker-protected disks efficiently. They highlight that this process takes only two seconds, emphasizing the importance of adhering to security policies. The speaker recounts a comment from a military individual regarding their article, acknowledging the good content but critiquing their operational security. The speaker defends the approach, emphasizing the need to make things unusable quickly in certain situations.

He then elaborate the importance of trusting BitLocker for encryption and argues that if someone insists on wiping every block, they effectively do not trust the encryption, making BitLocker unusable from the beginning. They emphasize the efficiency of using BitLocker for encryption and wiping. The speaker then transitions to the principle of least privilege, sharing their experience of removing admin rights from over a million end users in the past 20 years. They humorously describe being the most hated person in any company for implementing such changes. The speaker reflects on their own evolution, acknowledging that having more privileges means more work and expressing their current preference for limited privileges. They share a personal anecdote about being a domain admin for PepsiCo at 16 and how they have since shifted away from seeking unnecessary powers. The speaker highlights their decision to stop taking on additional powers in 2002 and shares a humorous incident related to Outlook smileys after removing admin rights from their girlfriend's computer.

He discusses the positive impact of removing admin rights, sharing personal experiences of reinstalling Windows frequently before adopting the principle of least privilege. They highlight the improvement in computer performance and reduced reinstallations after removing admin rights. The speaker emphasizes the ease of managing systems without admin rights and their personal preference for stability. They mention their choice to focus on Windows troubleshooting rather than Linux due to demand. The speaker notes that removing admin rights makes systems more productive and reliable, and they share examples of companies experiencing fewer service desk tickets and even purchasing shorter desks due to increased efficiency. The overall message is that the removal of admin rights contributes to better productivity and functionality within organizations.

Then he discusses the positive impact of removing admin rights and shares a story about Nestori, a fellow MVP, advising a new MVP to remove admin rights instead of switching to a Mac for better Windows performance. The speaker then demonstrates a fingerprint login method, emphasizing the benefits of using a normal user account for everyday tasks and switching to an admin account only when necessary. They highlight the improved performance and security aspects of not being an admin, including reduced malware risk and extended SSD lifespan. The speaker concludes by encouraging users to focus on the overall advantages of not having admin rights beyond just security.

Moving forward, he covers various topics, emphasizing the benefits of removing admin rights, including improved system performance, extended SSD lifespan, and fewer reinstalls. They share a story about a developer wanting to remove admin rights for better SSD longevity. The speaker stresses the advantages beyond security, such as increased productivity and fewer service desk tickets. They discuss the positive impact on a German developer's SSD and share an interesting experiment with Azure containers submerged underwater, experiencing fewer issues due to limited human interference. The speaker shifts to the importance of patching and reveals that patching has become a more critical factor than phishing for initial access in 2021. They share insights into vulnerabilities and mitigation, including the statistic that 59% of vulnerabilities can be mitigated by removing admin rights. The speaker introduces the concept of director tearing and emphasizes the significance of preventing domain admins from logging into endpoints to enhance security. They highlight the importance of privileged access workstations (PAWs) in making tiering effective and conclude by discussing the application of these principles in the cloud.

He emphasizes the importance of limiting the attack surface by implementing measures such as privileged access workstations (PAWs) and allowing domain admins to log on only to specific devices. They stress the need to prevent unauthorized RDP access to critical servers and suggest using alternative tools like PowerShell, Remote Server Administration Tools, or Windows Admin Center. The speaker criticizes the European practice of manually petting servers with RDP and advocates for treating servers like cattle, using automation for management. They highlight the drawbacks of using traditional jump servers and recommend virtualized PAWs for enhanced security. The speaker concludes by emphasizing the significance of never granting admin rights to PAWs and maintaining strict access controls.

Sami suggests implementing simple tips for reducing the attack surface on machines of less computer-savvy individuals:

1. **Remove Admin Rights**: Create a separate admin account and use it only when necessary.
2. **Firewall Rule for PowerShell**: Implement a firewall rule disallowing PowerShell from communicating outside, which can help prevent connections to command centers.
3. **Install Security Baselines**: Ensure that even users with Windows 10 or 11 Home versions install security baselines like CIS or Microsoft baselines to have optimal security settings.
4. **Physical Device for Management**: Encourage the use of physical devices for managing environments, discouraging remote desktop access from personal devices.
5. **Azure Virtual Desktop (AVD)**: Promote the use of Azure Virtual Desktop as a secure option for remote work, with conditional access controls to manage connections.

Sami emphasizes the importance of taking practical steps and not letting the pursuit of perfection hinder the adoption of good security practices.



